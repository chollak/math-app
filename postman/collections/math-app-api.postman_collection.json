{
  "info": {
    "name": "Math App API",
    "description": "Complete API collection for Math App with automatic tests, language filtering, and date-based exam history filtering",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "{{base_url}}",
      "type": "string"
    },
    {
      "key": "admin_token",
      "value": "{{admin_token}}",
      "type": "string"
    },
    {
      "key": "device_id",
      "value": "{{device_id}}",
      "type": "string"
    },
    {
      "key": "photo_filename",
      "value": "test-photo.jpg",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "üìù Questions",
      "description": "CRUD operations for questions with suboptions support",
      "item": [
        {
          "name": "Get All Questions",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Response is an array', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "});",
                  "",
                  "if (pm.response.json().length > 0) {",
                  "    pm.test('First question has required fields', function () {",
                  "        const question = pm.response.json()[0];",
                  "        pm.expect(question).to.have.property('id');",
                  "        pm.expect(question).to.have.property('question');",
                  "        pm.expect(question).to.have.property('options');",
                  "    });",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Russian Questions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept-Language",
                "value": "ru",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/questions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Only Russian questions returned (via Accept-Language header)', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    if (response.length > 0) {",
                  "        response.forEach(question => {",
                  "            pm.expect(question.language).to.equal('ru');",
                  "            pm.expect(question).to.have.property('question');",
                  "            pm.expect(question).to.not.have.property('question_kz');",
                  "        });",
                  "    }",
                  "});",
                  "",
                  "pm.test('Request sent Accept-Language header', function () {",
                  "    pm.expect(pm.request.headers.get('Accept-Language')).to.equal('ru');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Kazakh Questions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-App-Language",
                "value": "kz",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/questions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Only Kazakh questions returned (via X-App-Language header)', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    if (response.length > 0) {",
                  "        response.forEach(question => {",
                  "            pm.expect(question.language).to.equal('kz');",
                  "            pm.expect(question).to.have.property('question');",
                  "            pm.expect(question).to.not.have.property('question_ru');",
                  "        });",
                  "    }",
                  "});",
                  "",
                  "pm.test('Request sent X-App-Language header', function () {",
                  "    pm.expect(pm.request.headers.get('X-App-Language')).to.equal('kz');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Questions (Backward Compatibility)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions?language=ru",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions"
              ],
              "query": [
                {
                  "key": "language",
                  "value": "ru",
                  "description": "Backward compatibility - query parameter still works"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Backward compatibility: query parameter works', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    if (response.length > 0) {",
                  "        response.forEach(question => {",
                  "            pm.expect(question.language).to.equal('ru');",
                  "        });",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create Question (Simple)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Test question created by Postman\",\n  \"language\": \"ru\",\n  \"topic\": \"ALG\",\n  \"answer\": \"B\",\n  \"level\": 1,\n  \"options\": [\n    \"Option A\",\n    \"Option B\",\n    \"Option C\",\n    \"Option D\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/questions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Question created successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('id');",
                  "    pm.expect(response.question).to.equal('Test question created by Postman');",
                  "    ",
                  "    // Save question ID for other requests",
                  "    pm.collectionVariables.set('test_question_id', response.id);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create Question (With Suboptions)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Complex question with suboptions\",\n  \"language\": \"ru\",\n  \"topic\": \"EQS\",\n  \"answer\": \"A1B2\",\n  \"level\": 3,\n  \"options\": [\n    {\n      \"text\": \"A) Find x\",\n      \"suboptions\": [\n        {\n          \"text\": \"1\",\n          \"correct\": false\n        },\n        {\n          \"text\": \"2\",\n          \"correct\": true\n        },\n        {\n          \"text\": \"3\",\n          \"correct\": false\n        }\n      ]\n    },\n    {\n      \"text\": \"B) Find y\",\n      \"suboptions\": [\n        {\n          \"text\": \"4\",\n          \"correct\": false\n        },\n        {\n          \"text\": \"5\",\n          \"correct\": true\n        },\n        {\n          \"text\": \"6\",\n          \"correct\": false\n        }\n      ]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/questions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Complex question created with suboptions', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('id');",
                  "    pm.expect(response.options).to.be.an('array');",
                  "    pm.expect(response.options[0]).to.have.property('suboptions');",
                  "    ",
                  "    // Save complex question ID",
                  "    pm.collectionVariables.set('complex_question_id', response.id);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Question by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Question retrieved successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('id');",
                  "    pm.expect(response.id).to.equal(parseInt(pm.collectionVariables.get('test_question_id')));",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Question",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question\": \"Updated test question\",\n  \"language\": \"ru\",\n  \"topic\": \"GEO\",\n  \"answer\": \"C\",\n  \"level\": 2,\n  \"options\": [\n    \"New A\",\n    \"New B\",\n    \"New C\",\n    \"New D\"\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Question updated successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.question).to.equal('Updated test question');",
                  "    pm.expect(response.topic).to.equal('GEO');",
                  "    pm.expect(response).to.have.property('message');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Question (PATCH) - Text Only",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"question_ru\": \"Updated question text via PATCH\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Question updated partially', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.question).to.include('Updated question text via PATCH');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Question Photos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Response has photos array', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('photos');",
                  "    pm.expect(response.photos).to.be.an('array');",
                  "    pm.expect(response).to.have.property('count');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Add Photos to Question",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "photo1",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Photos added successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.message).to.include('added successfully');",
                  "    pm.expect(response.addedPhotos).to.be.an('array');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Replace All Question Photos",
          "request": {
            "method": "PUT",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "photo1",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Photos replaced successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.message).to.include('replaced successfully');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete All Question Photos",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('All photos deleted', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.message).to.include('deleted successfully');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete Specific Question Photo",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}/photos/{{photo_filename}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}",
                "photos",
                "{{photo_filename}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 404', function () {",
                  "    pm.expect([200, 404]).to.include(pm.response.code);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete Question",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/questions/{{test_question_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "questions",
                "{{test_question_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Question deleted successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.deleted).to.be.true;",
                  "    pm.expect(response).to.have.property('message');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "üìö Contexts",
      "description": "CRUD operations for question contexts",
      "item": [
        {
          "name": "Get All Contexts",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/contexts",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});"
                ]
              }
            }
          ]
        },
        {
          "name": "Create Context",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Test Context\",\n  \"text\": \"This is a test context created by Postman\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contexts",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Context created successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('id');",
                  "    pm.collectionVariables.set('test_context_id', response.id);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Context by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Context",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Test Context\",\n  \"text\": \"This context has been updated\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Context (PATCH) - Text Only",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"text\": \"Updated context text via PATCH\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Context updated partially', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.text).to.equal('Updated context text via PATCH');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Context (PATCH) - Clear Photos",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated title\",\n  \"clearPhotos\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Photos cleared', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.photos).to.be.an('array').that.is.empty;",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Context Photos",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Response has photos array', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('photos');",
                  "    pm.expect(response.photos).to.be.an('array');",
                  "    pm.expect(response).to.have.property('count');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Add Photos to Context",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "photo1",
                  "type": "file",
                  "src": []
                },
                {
                  "key": "photo2",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Photos added successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.message).to.include('added successfully');",
                  "    pm.expect(response.addedPhotos).to.be.an('array');",
                  "    pm.expect(response.addedPhotos.length).to.be.greaterThan(0);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Replace All Context Photos",
          "request": {
            "method": "PUT",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "photo1",
                  "type": "file",
                  "src": []
                }
              ]
            },
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Photos replaced successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.message).to.include('replaced successfully');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete All Context Photos",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}/photos",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}",
                "photos"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('All photos deleted', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.message).to.include('deleted successfully');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete Specific Context Photo",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}/photos/{{photo_filename}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}",
                "photos",
                "{{photo_filename}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Status code is 200 or 404', function () {",
                  "    pm.expect([200, 404]).to.include(pm.response.code);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Delete Context",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/contexts/{{test_context_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "contexts",
                "{{test_context_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "üìÅ Files",
      "description": "File management operations",
      "item": [
        {
          "name": "List All Files",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/files",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "files"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Files list returned', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('files');",
                  "    pm.expect(response).to.have.property('total');",
                  "    pm.expect(response.files).to.be.an('array');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "üéØ Exams",
      "description": "üéØ Advanced exam system with structured 40-question tests, smart scoring, and comprehensive validation. Features:\n\nüìç **Position-Based Question Types:**\n‚Ä¢ 1-15: Simple questions (level 1, 4 options, 1 point)\n‚Ä¢ 16-25: Complex questions (level 2, 4 options, 1 point) \n‚Ä¢ 26-30: Context questions (shared context, 4 options, 1 point)\n‚Ä¢ 31-35: Matching questions (suboptions, format: A1B2, 2 points)\n‚Ä¢ 36-40: Multiple choice (6 options, format: A,C,E, 2 points)\n\nüèÜ **Advanced Scoring Rules:**\n‚Ä¢ Simple/Complex/Context: 1 point for correct answer\n‚Ä¢ Matching: 1 –∏–∑ 2 = 1 –±–∞–ª–ª, 2 –∏–∑ 2 = 2 –±–∞–ª–ª–∞\n‚Ä¢ Multiple: Complex scoring based on correct/selected ratio\n\nüîç **Answer Format Validation:**\n‚Ä¢ Simple: Single letter (A, B, C, D)\n‚Ä¢ Matching: Letter-number pairs (A1B2C3)\n‚Ä¢ Multiple: Comma-separated (A,C,E)\n\nüìä **Maximum Score: 50 points** (30 + 10 + 10)",
      "item": [
        {
          "name": "Check Exam Readiness",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept-Language",
                "value": "ru",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/exams/readiness",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "readiness"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Readiness check returns valid data', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('isReady');",
                  "    pm.expect(response).to.have.property('timestamp');",
                  "    pm.expect(response).to.have.property('language');",
                  "    pm.expect(response).to.have.property('topicCoverage');",
                  "    pm.expect(response).to.have.property('typeCoverage');",
                  "    pm.expect(response).to.have.property('recommendedActions');",
                  "    pm.expect(response).to.have.property('summary');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "üöÄ Complete Structured Exam Workflow",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept-Language",
                "value": "ru",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/exams/readiness",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "readiness"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('üîç Database readiness check', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.isReady, 'Database should be ready for structured exams').to.be.true;",
                  "    ",
                  "    console.log('üìä Readiness Score:', response.summary.readinessScore + '%');",
                  "    console.log('üìù Total Topics Covered:', Object.keys(response.topicCoverage).length);",
                  "    console.log('üéØ Recommended Actions:', response.recommendedActions.length);",
                  "    ",
                  "    // Auto-proceed to next request if ready",
                  "    if (response.isReady) {",
                  "        postman.setNextRequest('Start Structured 40-Question Exam');",
                  "    } else {",
                  "        postman.setNextRequest(null);",
                  "        console.error('‚ùå Database not ready for structured exams!');",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "üß™ Scoring System Test Suite",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept-Language",
                "value": "ru",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"{{device_id}}\",\n  \"questionCount\": 40,\n  \"filters\": {}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/exams/start",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "start"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('üß™ Create test exam for scoring validation', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('examId');",
                  "    pm.expect(response.totalQuestions).to.equal(40);",
                  "    pm.collectionVariables.set('scoring_test_exam_id', response.examId);",
                  "    ",
                  "    console.log('üéØ Created test exam for scoring system validation');",
                  "    postman.setNextRequest('Test All Answer Format Scoring');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Test All Answer Format Scoring",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"{{device_id}}\",\n  \"answers\": [\n    {\n      \"questionId\": 1,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 2,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 3,\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": 4,\n      \"answer\": \"D\"\n    },\n    {\n      \"questionId\": 5,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 6,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 7,\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": 8,\n      \"answer\": \"D\"\n    },\n    {\n      \"questionId\": 9,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 10,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 11,\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": 12,\n      \"answer\": \"D\"\n    },\n    {\n      \"questionId\": 13,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 14,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 15,\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": 16,\n      \"answer\": \"D\"\n    },\n    {\n      \"questionId\": 17,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 18,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 19,\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": 20,\n      \"answer\": \"D\"\n    },\n    {\n      \"questionId\": 21,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 22,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 23,\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": 24,\n      \"answer\": \"D\"\n    },\n    {\n      \"questionId\": 25,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 26,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 27,\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": 28,\n      \"answer\": \"D\"\n    },\n    {\n      \"questionId\": 29,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 30,\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": 31,\n      \"answer\": \"A1B2\"\n    },\n    {\n      \"questionId\": 32,\n      \"answer\": \"A1B3\"\n    },\n    {\n      \"questionId\": 33,\n      \"answer\": \"A1B2C3\"\n    },\n    {\n      \"questionId\": 34,\n      \"answer\": \"A3B4\"\n    },\n    {\n      \"questionId\": 35,\n      \"answer\": \"A1\"\n    },\n    {\n      \"questionId\": 36,\n      \"answer\": \"A,B,C\"\n    },\n    {\n      \"questionId\": 37,\n      \"answer\": \"A,B\"\n    },\n    {\n      \"questionId\": 38,\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": 39,\n      \"answer\": \"A,B,D\"\n    },\n    {\n      \"questionId\": 40,\n      \"answer\": \"A,E,F\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/exams/{{scoring_test_exam_id}}/submit",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "{{scoring_test_exam_id}}",
                "submit"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('üßÆ Scoring system validation', function () {",
                  "    const response = pm.response.json();",
                  "    const exam = response.exam;",
                  "    const questions = response.questions;",
                  "    ",
                  "    // Expected max points for structured 40-question exam",
                  "    const expectedMaxPoints = 50; // 30*1 + 5*2 + 5*2",
                  "    ",
                  "    pm.expect(exam).to.have.property('totalPoints');",
                  "    pm.expect(exam).to.have.property('maxPossiblePoints');",
                  "    pm.expect(exam.maxPossiblePoints).to.equal(expectedMaxPoints);",
                  "    ",
                  "    console.log('üìä Total Points Earned:', exam.totalPoints);",
                  "    console.log('üìä Max Possible Points:', exam.maxPossiblePoints);",
                  "    console.log('üìä Percentage:', exam.percentage + '%');",
                  "    ",
                  "    // Validate question-specific scoring",
                  "    const simpleQuestions = questions.filter(q => q.questionOrder >= 1 && q.questionOrder <= 30);",
                  "    const matchingQuestions = questions.filter(q => q.questionOrder >= 31 && q.questionOrder <= 35);",
                  "    const multipleQuestions = questions.filter(q => q.questionOrder >= 36 && q.questionOrder <= 40);",
                  "    ",
                  "    console.log('üî¢ Simple questions max points:', simpleQuestions.reduce((sum, q) => sum + q.maxPoints, 0));",
                  "    console.log('üîó Matching questions max points:', matchingQuestions.reduce((sum, q) => sum + q.maxPoints, 0));",
                  "    console.log('‚úÖ Multiple questions max points:', multipleQuestions.reduce((sum, q) => sum + q.maxPoints, 0));",
                  "});",
                  "",
                  "pm.test('üìù Answer format processing verification', function () {",
                  "    const response = pm.response.json();",
                  "    const questions = response.questions;",
                  "    ",
                  "    // Check specific answer formats were processed",
                  "    const matchingQ31 = questions.find(q => q.questionOrder === 31);",
                  "    const multipleQ36 = questions.find(q => q.questionOrder === 36);",
                  "    ",
                  "    if (matchingQ31) {",
                  "        pm.expect(matchingQ31.userAnswer).to.include('A1B2');",
                  "        console.log('üîó Matching answer format (Q31):', matchingQ31.userAnswer);",
                  "    }",
                  "    ",
                  "    if (multipleQ36) {",
                  "        pm.expect(multipleQ36.userAnswer).to.include(',');",
                  "        console.log('‚úÖ Multiple choice format (Q36):', multipleQ36.userAnswer);",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Start Structured 40-Question Exam",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept-Language",
                "value": "ru",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"{{device_id}}\",\n  \"questionCount\": 40,\n  \"filters\": {}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/exams/start",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "start"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('üéØ Structured exam created successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('examId');",
                  "    pm.expect(response).to.have.property('totalQuestions');",
                  "    pm.expect(response.totalQuestions, '40 questions required').to.equal(40);",
                  "    pm.expect(response).to.have.property('isStructured');",
                  "    pm.expect(response.isStructured, 'Should be structured exam').to.be.true;",
                  "    ",
                  "    console.log('üìù Exam ID:', response.examId);",
                  "    console.log('üìä Total Questions:', response.totalQuestions);",
                  "    console.log('üèóÔ∏è Is Structured:', response.isStructured);",
                  "    if (response.contextUsed) {",
                  "        console.log('üìö Context Used:', response.contextUsed);",
                  "    }",
                  "    ",
                  "    // Save structured exam ID",
                  "    pm.collectionVariables.set('structured_exam_id', response.examId);",
                  "    ",
                  "    // Auto-proceed to validation",
                  "    postman.setNextRequest('Validate Structured Exam Questions');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Start Exam",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "Accept-Language",
                "value": "ru",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"{{device_id}}\",\n  \"questionCount\": 40,\n  \"filters\": {}\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/exams/start",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "start"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Exam started successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('examId');",
                  "    pm.expect(response).to.have.property('totalQuestions');",
                  "    ",
                  "    // Save exam ID for subsequent requests",
                  "    pm.collectionVariables.set('exam_id', response.examId);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Start Kazakh Exam",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-App-Language",
                "value": "kz",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"{{device_id}}\",\n  \"questionCount\": 20,\n  \"filters\": {\n    \"topic\": \"ALG\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/exams/start",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "start"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Kazakh exam started successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('examId');",
                  "    pm.expect(response).to.have.property('totalQuestions');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Exam Questions",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/{{exam_id}}/questions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "{{exam_id}}",
                "questions"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Exam questions retrieved', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    pm.expect(response.length).to.be.greaterThan(0);",
                  "    ",
                  "    // Save first question ID for answers",
                  "    if (response.length > 0) {",
                  "        pm.collectionVariables.set('first_question_id', response[0].questionId);",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Validate Structured Exam Questions",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept-Language",
                "value": "ru",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/exams/{{structured_exam_id}}/questions",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "{{structured_exam_id}}",
                "questions"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Structured exam has correct number of questions', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    pm.expect(response.length).to.equal(40);",
                  "});",
                  "",
                  "pm.test('Questions 1-15 are simple (level 1)', function () {",
                  "    const response = pm.response.json();",
                  "    const simpleQuestions = response.slice(0, 15);",
                  "    simpleQuestions.forEach((q, index) => {",
                  "        pm.expect(q.level, `Question ${index + 1} should be level 1`).to.equal(1);",
                  "        pm.expect(q.options, `Question ${index + 1} should have 4 options`).to.be.an('array').with.length(4);",
                  "    });",
                  "});",
                  "",
                  "pm.test('Questions 16-25 are complex (level 2)', function () {",
                  "    const response = pm.response.json();",
                  "    const complexQuestions = response.slice(15, 25);",
                  "    complexQuestions.forEach((q, index) => {",
                  "        pm.expect(q.level, `Question ${index + 16} should be level 2`).to.equal(2);",
                  "        pm.expect(q.options, `Question ${index + 16} should have 4 options`).to.be.an('array').with.length(4);",
                  "    });",
                  "});",
                  "",
                  "pm.test('Questions 26-30 are context questions', function () {",
                  "    const response = pm.response.json();",
                  "    const contextQuestions = response.slice(25, 30);",
                  "    let contextId = null;",
                  "    contextQuestions.forEach((q, index) => {",
                  "        pm.expect(q.contextId, `Question ${index + 26} should have context`).to.not.be.null;",
                  "        if (contextId === null) {",
                  "            contextId = q.contextId;",
                  "        } else {",
                  "            pm.expect(q.contextId, `Question ${index + 26} should use same context`).to.equal(contextId);",
                  "        }",
                  "    });",
                  "});",
                  "",
                  "pm.test('Questions 36-40 are multiple choice (6 options)', function () {",
                  "    const response = pm.response.json();",
                  "    const multipleQuestions = response.slice(35, 40);",
                  "    multipleQuestions.forEach((q, index) => {",
                  "        pm.expect(q.options, `Question ${index + 36} should have 6 options`).to.be.an('array').with.length(6);",
                  "    });",
                  "});",
                  "",
                  "pm.test('Question topics follow the structure', function () {",
                  "    const response = pm.response.json();",
                  "    const expectedTopics = [",
                  "        'RAD', 'POW', 'TRG', 'ALG', 'EQS', 'SYS', 'CAL', 'GEO', 'INS', 'TRE',",
                  "        'CAL', 'INE', 'GEO', 'CAL', 'SPA', // 1-15",
                  "        'EXL', 'SYM', 'CAL', 'GEO', 'PRG', 'VEC', 'ALG', 'EXL', 'INE', 'CAL' // 16-25",
                  "    ];",
                  "    ",
                  "    // Check first 25 questions have expected topics",
                  "    for (let i = 0; i < 25; i++) {",
                  "        pm.expect(response[i].topic, `Question ${i + 1} should have topic ${expectedTopics[i]}`).to.equal(expectedTopics[i]);",
                  "    }",
                  "    ",
                  "    // Save question IDs for testing different answer types",
                  "    if (response.length >= 36) {",
                  "        pm.collectionVariables.set('question_1_id', response[0].questionId);",
                  "        pm.collectionVariables.set('question_16_id', response[15].questionId);",
                  "        pm.collectionVariables.set('question_26_id', response[25].questionId);",
                  "        pm.collectionVariables.set('question_31_id', response[30].questionId);",
                  "        pm.collectionVariables.set('question_36_id', response[35].questionId);",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Submit Structured Exam (Test All Answer Types)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"{{device_id}}\",\n  \"answers\": [\n    {\n      \"questionId\": \"{{question_1_id}}\",\n      \"answer\": \"A\"\n    },\n    {\n      \"questionId\": \"{{question_16_id}}\",\n      \"answer\": \"B\"\n    },\n    {\n      \"questionId\": \"{{question_26_id}}\",\n      \"answer\": \"C\"\n    },\n    {\n      \"questionId\": \"{{question_31_id}}\",\n      \"answer\": \"A1B2\"\n    },\n    {\n      \"questionId\": \"{{question_36_id}}\",\n      \"answer\": \"A,C,E\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/exams/{{structured_exam_id}}/submit",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "{{structured_exam_id}}",
                "submit"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Structured exam submitted successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('exam');",
                  "    pm.expect(response).to.have.property('questions');",
                  "    pm.expect(response.exam).to.have.property('totalPoints');",
                  "    pm.expect(response.exam).to.have.property('maxPossiblePoints');",
                  "});",
                  "",
                  "pm.test('Answer formats are properly processed', function () {",
                  "    const response = pm.response.json();",
                  "    const questions = response.questions;",
                  "    ",
                  "    // Check that we have answers for different question types",
                  "    pm.expect(questions.length).to.be.greaterThan(0);",
                  "    ",
                  "    // Look for different answer formats in the response",
                  "    const hasSimpleAnswer = questions.some(q => q.userAnswer && q.userAnswer.length === 1);",
                  "    const hasMatchingAnswer = questions.some(q => q.userAnswer && q.userAnswer.match(/[A-Z][0-9]/));",
                  "    const hasMultipleAnswer = questions.some(q => q.userAnswer && q.userAnswer.includes(','));",
                  "    ",
                  "    console.log('Simple answers found:', hasSimpleAnswer);",
                  "    console.log('Matching answers found:', hasMatchingAnswer);",
                  "    console.log('Multiple answers found:', hasMultipleAnswer);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Submit Exam",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"deviceId\": \"{{device_id}}\",\n  \"answers\": [\n    {\n      \"questionId\": \"{{first_question_id}}\",\n      \"answer\": \"A\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/exams/{{exam_id}}/submit",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "{{exam_id}}",
                "submit"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Exam submitted successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('exam');",
                  "    pm.expect(response).to.have.property('questions');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Exam History (All)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('History returned successfully', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    ",
                  "    if (response.length > 0) {",
                  "        pm.expect(response[0]).to.have.property('id');",
                  "        pm.expect(response[0]).to.have.property('deviceId');",
                  "        pm.expect(response[0]).to.have.property('startedAt');",
                  "        pm.expect(response[0]).to.have.property('completedAt');",
                  "        pm.expect(response[0]).to.have.property('totalQuestions');",
                  "        pm.expect(response[0]).to.have.property('totalPoints');",
                  "        pm.expect(response[0]).to.have.property('maxPossiblePoints');",
                  "        pm.expect(response[0]).to.have.property('scorePercentage');",
                  "        pm.expect(response[0]).to.have.property('status');",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Exam History (Date Range Filter)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}?startDate=2024-01-01&endDate=2024-12-31",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ],
              "query": [
                {
                  "key": "startDate",
                  "value": "2024-01-01",
                  "description": "Start date filter (YYYY-MM-DD format)"
                },
                {
                  "key": "endDate",
                  "value": "2024-12-31",
                  "description": "End date filter (YYYY-MM-DD format)"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Date range filter works correctly', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    ",
                  "    if (response.length > 0) {",
                  "        response.forEach((exam, index) => {",
                  "            pm.expect(exam.completedAt, `Exam ${index + 1} completion date should be within range`).to.match(/^2024/);",
                  "        });",
                  "    }",
                  "});",
                  "",
                  "pm.test('Request query parameters are correct', function () {",
                  "    pm.expect(pm.request.url.query.get('startDate')).to.equal('2024-01-01');",
                  "    pm.expect(pm.request.url.query.get('endDate')).to.equal('2024-12-31');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Exam History (Started Date Filter)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}?startDate=2024-11-01&dateField=started_at",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ],
              "query": [
                {
                  "key": "startDate",
                  "value": "2024-11-01",
                  "description": "Filter exams started from this date"
                },
                {
                  "key": "dateField",
                  "value": "started_at",
                  "description": "Use started_at field for date filtering"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Started date filter works', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    ",
                  "    if (response.length > 0) {",
                  "        response.forEach((exam, index) => {",
                  "            const startDate = new Date(exam.startedAt);",
                  "            const filterDate = new Date('2024-11-01');",
                  "            pm.expect(startDate.getTime(), `Exam ${index + 1} start date should be after filter date`).to.be.at.least(filterDate.getTime());",
                  "        });",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Exam History (Limit Test)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}?limit=5",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ],
              "query": [
                {
                  "key": "limit",
                  "value": "5",
                  "description": "Limit results to 5 exams"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('Limit parameter respected', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    pm.expect(response.length).to.be.at.most(5);",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Exam History (ISO DateTime Filter)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}?startDate=2024-01-15T00:00:00&endDate=2024-01-15T23:59:59",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ],
              "query": [
                {
                  "key": "startDate",
                  "value": "2024-01-15T00:00:00",
                  "description": "Start of specific day (ISO format)"
                },
                {
                  "key": "endDate",
                  "value": "2024-01-15T23:59:59",
                  "description": "End of specific day (ISO format)"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});",
                  "",
                  "pm.test('ISO datetime format accepted', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.be.an('array');",
                  "    ",
                  "    // Should return exams from specific day only",
                  "    if (response.length > 0) {",
                  "        response.forEach((exam, index) => {",
                  "            pm.expect(exam.completedAt, `Exam ${index + 1} should be from Jan 15, 2024`).to.include('2024-01-15');",
                  "        });",
                  "    }",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Test Invalid Date Filter (Should Fail)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}?startDate=invalid-date&endDate=2024-13-45",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ],
              "query": [
                {
                  "key": "startDate",
                  "value": "invalid-date",
                  "description": "Invalid date format"
                },
                {
                  "key": "endDate",
                  "value": "2024-13-45",
                  "description": "Invalid date (month 13, day 45)"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Invalid date format returns 400 error', function () {",
                  "    pm.expect(pm.response.code).to.equal(400);",
                  "});",
                  "",
                  "pm.test('Error response contains validation details', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response).to.have.property('error');",
                  "    pm.expect(response.error).to.equal('Invalid date filter parameters');",
                  "    pm.expect(response).to.have.property('details');",
                  "    pm.expect(response.details).to.be.an('array');",
                  "    pm.expect(response).to.have.property('supportedFormats');",
                  "    pm.expect(response).to.have.property('examples');",
                  "});",
                  "",
                  "pm.test('Multiple validation errors reported', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.details.length).to.be.at.least(2);",
                  "    ",
                  "    const fields = response.details.map(error => error.field);",
                  "    pm.expect(fields).to.include('startDate');",
                  "    pm.expect(fields).to.include('endDate');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Test Invalid Date Field (Should Fail)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}?dateField=invalid_field&startDate=2024-01-01",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ],
              "query": [
                {
                  "key": "dateField",
                  "value": "invalid_field",
                  "description": "Invalid date field name"
                },
                {
                  "key": "startDate",
                  "value": "2024-01-01",
                  "description": "Valid start date"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Invalid dateField returns 400 error', function () {",
                  "    pm.expect(pm.response.code).to.equal(400);",
                  "});",
                  "",
                  "pm.test('Error specifies invalid dateField', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.details[0].field).to.equal('dateField');",
                  "    pm.expect(response.supportedDateFields).to.include('started_at');",
                  "    pm.expect(response.supportedDateFields).to.include('completed_at');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "Test Invalid Limit Parameter (Should Fail)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/exams/history/{{device_id}}?limit=300",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "exams",
                "history",
                "{{device_id}}"
              ],
              "query": [
                {
                  "key": "limit",
                  "value": "300",
                  "description": "Limit exceeds maximum allowed (200)"
                }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Invalid limit returns 400 error', function () {",
                  "    pm.expect(pm.response.code).to.equal(400);",
                  "});",
                  "",
                  "pm.test('Error specifies limit validation', function () {",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.error).to.equal('Invalid limit parameter');",
                  "    pm.expect(response.message).to.include('between 1 and 200');",
                  "});"
                ]
              }
            }
          ]
        }
      ]
    },
    {
      "name": "‚öôÔ∏è System",
      "description": "System endpoints and health checks",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "health"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Health check successful', function () {",
                  "    pm.response.to.have.status(200);",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.status).to.equal('OK');",
                  "    pm.expect(response).to.have.property('database');",
                  "});"
                ]
              }
            }
          ]
        },
        {
          "name": "API Documentation",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                ""
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});"
                ]
              }
            }
          ]
        },
        {
          "name": "Get User Stats",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/users/{{device_id}}/stats",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "users",
                "{{device_id}}",
                "stats"
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is successful\", function () {\n    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);\n});\n\npm.test(\"Response time is less than 5000ms\", function () {\n    pm.expect(pm.response.responseTime).to.be.below(5000);\n});\n\npm.test(\"Response has correct Content-Type\", function () {\n    pm.expect(pm.response.headers.get(\"Content-Type\")).to.include(\"application/json\");\n});"
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}